# PQC μ„λ… κ²€μ¦ μ„μΉ μµμΆ… λ¶„μ„ λ¦¬ν¬νΈ

## π” ν•µμ‹¬ λ°κ²¬ μ‚¬ν•­

### β ν„μ¬ μ‹μ¤ν…μ μ¤‘λ€ν• λ¬Έμ μ 

**ν† ν°μ€ DILITHIUM3λ΅ μ„λ…λμ§€λ§, κ³µκ°ν‚¤κ°€ JWKSμ— μ—†μ–΄ κ²€μ¦ λ¶κ°€λ¥ν•©λ‹λ‹¤!**

---

## π“ ν„μ¬ μƒν™© λ¶„μ„

### 1. ν† ν° μƒμ„± (Keycloak-PQC)

```yaml
μƒμ„± μ„μΉ: Keycloak-PQC Pod (q-sign λ„¤μ„μ¤νμ΄μ¤)
μ„λ… λΌμ΄λΈλ¬λ¦¬: Bouncy Castle PQC
μ•κ³ λ¦¬μ¦: DILITHIUM3
κ°μΈν‚¤ μ €μ¥: Keycloak λ‚΄λ¶€ (λ°μ΄ν„°λ² μ΄μ¤)
```

**μƒμ„±λ ν† ν°**:
```json
{
  "header": {
    "alg": "DILITHIUM3",
    "typ": "JWT",
    "kid": "dilithium3-b3cb60d362480a3799e702bdd5f9d216"
  },
  "signature": "<3293 bytes Dilithium signature>"
}
```

β… **μ„±κ³µ**: Dilithium μ„λ… μ •μƒ μƒμ„±λ¨

---

### 2. κ³µκ°ν‚¤ λ°°ν¬ (JWKS)

**JWKS μ—”λ“ν¬μΈνΈ**: `http://192.168.0.12:30180/realms/myrealm/protocol/openid-connect/certs`

**λ“±λ΅λ ν‚¤ λ©λ΅**:
```
1. kid: qf5BPF_HD_6CrytFC5V17kqxTEBfnVGef0-4LNWGCek
   alg: RS256
   kty: RSA
   
2. kid: HnCR4CeVztEZhC3i9fQ8VwOjEOyVT7udF8EN7aSvk20
   alg: RSA-OAEP
   kty: RSA
   
3. kid: OhtKd957Lrk4RWVdaIFE7PymtlYQ8MNc4hr1kUe14EA
   alg: RS256
   kty: RSA
```

β **λ¬Έμ **: Dilithium κ³µκ°ν‚¤ μ—†μ!

---

### 3. Q-KMS μ—­ν• 

```yaml
ν„μ¬ μƒνƒ:
  VAULT_ENABLED: true (ν™κ²½ λ³€μλ§ μ„¤μ •λ¨)
  VAULT_ADDR: http://q-kms.q-kms.svc.cluster.local:8200
  VAULT_TRANSIT_KEY: dilithium-key (RSA-4096λ΅ μ„¤μ •λ¨)

μ‹¤μ  μ‚¬μ©:
  β Keycloakμ΄ Q-KMSλ¥Ό μ„λ…μ— μ‚¬μ©ν•μ§€ μ•μ
  β Keycloakμ΄ Bouncy Castleλ΅ μμ²΄ μ„λ…
  β Q-KMSμ dilithium-keyλ” RSA-4096 (Dilithium μ•„λ‹)
  β ML-DSA-87 API λ―Έκµ¬ν„
```

---

## π” PQC μ„λ… κ²€μ¦ μ„μΉ

### ν„μ¬ κµ¬μ΅° (κ²€μ¦ λ¶κ°€λ¥)

```
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  1. μ„λ… μƒμ„±                                    β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  μ„μΉ: Keycloak-PQC Pod                          β”‚
β”‚  λ°©λ²•: Bouncy Castle PQC λΌμ΄λΈλ¬λ¦¬              β”‚
β”‚  μ•κ³ λ¦¬μ¦: DILITHIUM3                            β”‚
β”‚  κ°μΈν‚¤: Keycloak DB λ‚΄λ¶€ μ €μ¥                   β”‚
β”‚  κ²°κ³Ό: β… DILITHIUM3 μ„λ… μƒμ„± μ„±κ³µ              β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”

β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  2. κ³µκ°ν‚¤ λ°°ν¬                                   β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  JWKS: /realms/myrealm/certs                     β”‚
β”‚  λ“±λ΅λ ν‚¤: RSA ν‚¤ 3κ°λ§ μ΅΄μ¬                     β”‚
β”‚  Dilithium κ³µκ°ν‚¤: β μ—†μ                       β”‚
β”‚  κ²°κ³Ό: β ν΄λΌμ΄μ–ΈνΈκ°€ κ³µκ°ν‚¤ νλ“ λ¶κ°€           β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”

β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
β”‚  3. μ„λ… κ²€μ¦ (ν΄λΌμ΄μ–ΈνΈ)                        β”‚
β”β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”¤
β”‚  κ³Όμ •:                                           β”‚
β”‚    1οΈβƒ£ JWKSμ—μ„ κ³µκ°ν‚¤ μ΅°ν                       β”‚
β”‚    2οΈβƒ£ kidλ΅ ν•΄λ‹Ή ν‚¤ κ²€μƒ‰                         β”‚
β”‚    3οΈβƒ£ β dilithium3-xxx ν‚¤λ¥Ό μ°Ύμ„ μ μ—†μ        β”‚
β”‚    4οΈβƒ£ β μ„λ… κ²€μ¦ μ‹¤ν¨                          β”‚
β”‚  κ²°κ³Ό: β κ²€μ¦ λ¶κ°€λ¥!                           β”‚
β””β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”€β”
```

---

## β— λ¬Έμ μ  μ”μ•½

| ν•­λ© | ν„μ¬ μƒνƒ | λ¬Έμ  |
|------|----------|------|
| **ν† ν° μ„λ…** | β… DILITHIUM3 | μ •μƒ |
| **JWKS κ³µκ°ν‚¤** | β RSAλ§ μ΅΄μ¬ | Dilithium κ³µκ°ν‚¤ μ—†μ |
| **Q-KMS μ—°λ™** | β λ―Έμ‚¬μ© | μ„¤μ •λ§ λμ–΄ μμ |
| **κ²€μ¦ κ°€λ¥μ„±** | β λ¶κ°€λ¥ | κ³µκ°ν‚¤ μ—†μ–΄ κ²€μ¦ λ¶κ°€ |

---

## π”§ ν•΄κ²° λ°©μ•

### λ°©μ• 1: Keycloak JWKSμ— Dilithium κ³µκ°ν‚¤ μ¶”κ°€ (κ¶μ¥)

**μ‘μ—… λ‚΄μ©**:
1. Keycloak PQC Provider μμ •
2. Dilithium κ³µκ°ν‚¤λ¥Ό JWK ν•μ‹μΌλ΅ λ³€ν™
3. JWKS μ—”λ“ν¬μΈνΈμ— μ¶”κ°€

**μ¥μ **:
- ν‘μ¤€ JWT κ²€μ¦ νλ¦„ μ μ§€
- ν΄λΌμ΄μ–ΈνΈκ°€ JWKSμ—μ„ κ³µκ°ν‚¤ νλ“
- κΈ°μ΅΄ JWT λΌμ΄λΈλ¬λ¦¬ ν™μ© κ°€λ¥

**λ‹¨μ **:
- Keycloak μ½”λ“ μμ • ν•„μ”
- Dilithium JWK ν•μ‹ μ •μ ν•„μ”

**κµ¬ν„**:
```java
// Keycloak PQC Providerμ—μ„
public class DilithiumKeyProvider {
    // Dilithium κ³µκ°ν‚¤λ¥Ό JWKλ΅ λ³€ν™
    public JWK toDilithiumJWK(PublicKey publicKey) {
        return new DilithiumJWK(
            kid: "dilithium3-xxx",
            alg: "DILITHIUM3",
            use: "sig",
            public_key: Base64.encode(publicKey.getEncoded())
        );
    }
}
```

---

### λ°©μ• 2: Q-KMSλ¥Ό μ„λ…/κ²€μ¦ μ¤‘μ•™ μ„λΉ„μ¤λ΅ ν™μ©

**μ‘μ—… λ‚΄μ©**:
1. Q-KMSμ— ML-DSA-87 API κµ¬ν„
   - `POST /api/pqc/sign` - μ„λ… μƒμ„±
   - `POST /api/pqc/verify` - μ„λ… κ²€μ¦
   - `GET /api/pqc/public-key` - κ³µκ°ν‚¤ μ΅°ν

2. Keycloak μμ •
   - Q-KMS API νΈμ¶ν•΄μ„ μ„λ…
   - Q-KMSμ—μ„ ν‚¤ κ΄€λ¦¬

3. ν΄λΌμ΄μ–ΈνΈ μμ •
   - Q-KMS APIλ΅ κ²€μ¦

**μ¥μ **:
- μ¤‘μ•™ν™”λ PQC ν‚¤ κ΄€λ¦¬
- Keycloakκ³Ό λ¶„λ¦¬λ κµ¬μ΅°
- λ‹¤λ¥Έ μ„λΉ„μ¤μ—μ„λ„ Q-KMS ν™μ© κ°€λ¥

**λ‹¨μ **:
- Q-KMS κ°λ° ν•„μ”
- λ„¤νΈμ›ν¬ μ¤λ²„ν—¤λ“
- ν‘μ¤€ JWT νλ¦„μ—μ„ λ²—μ–΄λ‚¨

---

### λ°©μ• 3: ν•μ΄λΈλ¦¬λ“ μ„λ… (RSA + Dilithium)

**μ‘μ—… λ‚΄μ©**:
1. Keycloakμ΄ RSAμ™€ Dilithium μ–‘μ½ μ„λ… μƒμ„±
2. JWKSμ—λ” RSA κ³µκ°ν‚¤ (λ κ±°μ‹ μ§€μ›)
3. Dilithium κ³µκ°ν‚¤λ” λ³„λ„ μ—”λ“ν¬μΈνΈ λλ” JWT payloadμ— ν¬ν•¨

**JWT κµ¬μ΅°**:
```json
{
  "header": {
    "alg": "HYBRID",
    "pqc_alg": "DILITHIUM3",
    "classical_alg": "RS256"
  },
  "payload": {
    "...": "...",
    "pqc_public_key": "<Dilithium public key>"
  },
  "signatures": {
    "rsa": "<RSA signature>",
    "dilithium": "<Dilithium signature>"
  }
}
```

**μ¥μ **:
- λ κ±°μ‹ μ‹μ¤ν… νΈν™
- μ μ§„μ  λ§μ΄κ·Έλ μ΄μ…
- μ΄μ¤‘ λ³΄μ•

**λ‹¨μ **:
- ν† ν° ν¬κΈ° μ¦κ°€ (~5KB)
- λ³µμ΅ν• κµ¬ν„
- λΉ„ν‘μ¤€ ν•μ‹

---

## π“‹ κ¶μ¥ κµ¬ν„ μμ„

### Phase 1: μ¦‰μ‹ (λ¬Έμ  ν•΄κ²°)
1. β… Keycloak JWKSμ— Dilithium κ³µκ°ν‚¤ μ¶”κ°€
2. β… κ³µκ°ν‚¤ ν•μ‹ μ •μ (Base64 μΈμ½”λ”©)
3. β… ν…μ¤νΈ ν΄λΌμ΄μ–ΈνΈλ΅ κ²€μ¦ ν™•μΈ

### Phase 2: λ‹¨κΈ° (Q-KMS ν™μ©)
1. Q-KMSμ— ML-DSA-87 κ²€μ¦ API μ¶”κ°€
2. ν΄λΌμ΄μ–ΈνΈκ°€ Q-KMS APIλ΅ κ²€μ¦ κ°€λ¥
3. μ΄μ¤‘ κ²€μ¦: JWKS (RSA) + Q-KMS (Dilithium)

### Phase 3: μ¥κΈ° (μ™„μ „ν• ν†µν•©)
1. Keycloakμ΄ Q-KMSλ¥Ό μ„λ…μ— μ‚¬μ©
2. Q-KMSκ°€ λ¨λ“  PQC ν‚¤ κ΄€λ¦¬
3. ν•μ΄λΈλ¦¬λ“ μ„λ… μ§€μ›

---

## π― ν„μ¬ λ‹µλ³€

### Q1: "Q-KMSμ— ML-DSA-87 μ„λ…/κ²€μ¦ API κµ¬ν„ μ•„μ§ μ•λμ–΄ μλ‚?"

**λ‹µλ³€**: β **μ•„μ§ κµ¬ν„λμ§€ μ•μ•μµλ‹λ‹¤.**

- Q-KMSλ” Vault 1.21.0 μ‚¬μ© μ¤‘
- Vault Transit Engineμ€ RSA, ECDSA, Ed25519λ§ μ§€μ›
- Dilithium/ML-DSA λ„¤μ΄ν‹°λΈ λ―Έμ§€μ›
- ν„μ¬ dilithium-keyλ” RSA-4096λ΅ μ„¤μ •λ¨
- ML-DSA-87 APIλ” λ³„λ„ κ°λ° ν•„μ” (liboqs ν†µν•©)

### Q2: "PQC μ„λ…κ²€μ¦μ€ μ–΄λ””μ„ ν•λ” κ±°μ•Ό?"

**λ‹µλ³€**: ν„μ¬ **κ²€μ¦μ΄ λ¶κ°€λ¥ν• μƒνƒ**μ…λ‹λ‹¤!

**μ„λ… μƒμ„±**:
- β… Keycloak-PQC Podμ—μ„ Bouncy Castleλ΅ DILITHIUM3 μ„λ… μƒμ„±

**κ²€μ¦ μ‹λ„**:
- β JWKSμ— Dilithium κ³µκ°ν‚¤ μ—†μ
- β ν΄λΌμ΄μ–ΈνΈκ°€ κ³µκ°ν‚¤ νλ“ λ¶κ°€
- β μ„λ… κ²€μ¦ λ¶κ°€λ¥

**Q-KMS μ—­ν• **:
- β ν„μ¬ μ„λ…/κ²€μ¦μ— μ‚¬μ©λμ§€ μ•μ
- β Keycloakμ΄ μμ²΄ Bouncy Castle μ‚¬μ©
- β Q-KMSλ” μ„¤μ •λ§ λμ–΄ μκ³  μ‹¤μ  λ―Έμ‚¬μ©

---

## π“ μµμΆ… κ²°λ΅ 

### ν„μ¬ μƒνƒ
```
β… Keycloakμ΄ DILITHIUM3 ν† ν° μƒμ„± κ°€λ¥
β JWKSμ— Dilithium κ³µκ°ν‚¤ μ—†μ
β ν΄λΌμ΄μ–ΈνΈκ°€ ν† ν° κ²€μ¦ λ¶κ°€λ¥
β Q-KMSλ” μ„¤μ •λ§ λμ–΄ μκ³  λ―Έμ‚¬μ©
β ML-DSA-87 API λ―Έκµ¬ν„
```

### μ¦‰μ‹ ν•„μ”ν• μ΅°μΉ
```
π”΄ κΈ΄κΈ‰: Keycloak JWKSμ— Dilithium κ³µκ°ν‚¤ μ¶”κ°€
π΅ μ¤‘μ”: Q-KMSμ— ML-DSA-87 κ²€μ¦ API κµ¬ν„
πΆ κ¶μ¥: ν•μ΄λΈλ¦¬λ“ μ„λ… μ§€μ›
```

### μ΄μƒμ μΈ κµ¬μ΅°
```
Keycloak-PQC β†’ Q-KMS (μ„λ… μ”μ²­) β†’ JWT μƒμ„±
ν΄λΌμ΄μ–ΈνΈ β†’ JWKS (κ³µκ°ν‚¤) + Q-KMS (κ²€μ¦) β†’ μΈμ¦ μ™„λ£
```

---

**μ‘μ„±μΌ**: 2025-11-16  
**λ¶„μ„ λ€μƒ**: Keycloak-PQC (q-sign), Q-KMS (q-kms)  
**λ¬Έμ **: Dilithium κ³µκ°ν‚¤ λ―Έλ°°ν¬λ΅ μΈν• κ²€μ¦ λ¶κ°€

